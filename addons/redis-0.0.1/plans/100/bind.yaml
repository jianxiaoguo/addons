credential:
  {{- if not .Values.sentinel.enabled }}
  - name: MASTERHOST
    value: {{ template "redis.fullname" . }}-master.{{ .Release.Namespace }}.svc.cluster.local

  - name: MASTERPORT
    valueFrom:
      serviceRef:
        name: {{ template "redis.fullname" . }}-master
        jsonpath: '{ .spec.ports[?(@.name=="redis")].port }'
  {{- end }}

  {{- if .Values.sentinel.enabled }}
  - name: SENTINELHOST
    value: {{ template "redis.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local

  - name: SENTINELPORT
    valueFrom:
      serviceRef:
        name: {{ template "redis.fullname" . }}-sentinel
        {{- if .Values.master.service.nodePort }}
        jsonpath: '{ .spec.ports[?(@.name=="redis")].nodePort }'
        { {- else } }
        jsonpath: '{ .spec.ports[?(@.name=="redis")].port }'
        { {- end } }

  - name: REDISPORT
    valueFrom:
      serviceRef:
        name: {{ template "redis.fullname" . }}-sentinel
        {{-if .Values.sentinel.service.redisNodePort }}
        jsonpath: '{ .spec.ports[?(@.name=="redis-sentinel")].nodePort }'
        { {- else } }
        jsonpath: '{ .spec.ports[?(@.name=="redis-sentinel")].port }'
        { {- end } }
  {{- end }}

  {{- if and .Values.cluster.enabled (not .Values.sentinel.enabled) }}
  - name: SLAVEHOST
    value: {{ template "redis.fullname" . }}-slave.{{ .Release.Namespace }}.svc.cluster.local

  - name: SLAVEPORT
    valueFrom:
      serviceRef:
        name: {{ template "redis.fullname" . }}-slave
        jsonpath: '{ .spec.ports[?(@.name=="redis")].port }'
  {{- end }}

{{- if .Values.usePassword }}
  - name: REDIS_PASSWORD
    valueFrom:
      secretKeyRef:
        name: {{ template "redis.fullname" . }}
        key: redis-password
{{- end }}
